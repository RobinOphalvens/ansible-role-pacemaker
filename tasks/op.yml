---
- name: >-
    Create operation {{ op_properties.name | mandatory }}
    interval {{ op_properties.interval | mandatory }}
  xml:
    path: "{{ xml_path }}"
    xpath: >-
      {{ op_parent ~ ('/op[@id="%s-%s-interval-%s"]'
      | format(parent_id, op_properties.name, op_properties.interval)) }}

- name: >-
    Set properties for {{ op_properties.name }}
    interval {{ op_properties.interval | mandatory }}
  xml:
    path: "{{ xml_path }}"
    xpath: >-
      {{ op_parent ~ ('/op[@id="%s-%s-interval-%s"]'
      | format(parent_id, op_properties.name, op_properties.interval)) }}
    attribute: "{{ prop_key }}"
    value: |-
      {%  if op_properties[prop_key] is sameas(true) %}
      {{    'true' }}
      {%- elif op_properties[prop_key] is sameas(false) %}
      {{    'false' }}
      {%- else %}
      {{    op_properties[prop_key] }}
      {%- endif %}
  loop: "{{ op_properties.keys() }}"
  loop_control:
    loop_var: prop_key
    label: "{{ '{' ~ prop_key ~ ': ' ~ op_properties[prop_key] ~ '}' }}"
